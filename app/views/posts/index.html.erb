<div class="pt-[96px]">
    <% if notice %>
        <p class="my-3">
        <span class="d-block notice"> 
            <%= notice %> 
        </span>
        </p>
    <% end %>

    <% content_for :title, "Posts" %>

    <div id="posts">
    <div class="container">

    <nav aria-label="Page navigation">
      <ul class="pagination pagination-lg justify-content-center">
        <%== pagy_bootstrap_nav(@pagy) %>
      </ul>
    </nav>

    <div class="row justify-content-center">
      <div class="col-12 col-sm-6 mb-4">

        <% @posts.each do |post| %>

          <%= render post %>

          <% if (comment = post.comments.last) %>  <!-- Asigno el último comentario y verifico si existe -->
          
            <h6 class="mt-2">Último comentario, realizado el <%= l(comment.created_at, format: :long) %></h6>

            <div class="my-2 border rounded-2">

              <div class="mx-3 mb-2"> 
                <strong class="d-inline-block">Usuario   </strong> : <%= comment.user.name if comment.user %> 
                <br>
                <strong class="d-inline-block">Comentario</strong> : <%= comment.content %> 
              </div>

              <% if user_signed_in? && current_user.admin? %> 
                <%= button_to "Eliminar comentario", post_comment_path(post, comment), method: :delete, data: { confirm: "¿Estás seguro de que deseas eliminar este comentario?" }, class: "mb-3 mx-3 btn btn-warning" %>
              <% end %>

            </div>

          <% end %>
 
          <%= form_with(model: [ post, Comment.new ]) do |form| %>

            <div class="form-group my-2">
              <%= form.label :content, "Ingresa tu comentario" %>
              <%= form.text_area :content, class: "form-control" %>
            </div>
            <%= form.submit "Comentar", class: "btn btn-primary" %>

          <% end %>
          <br>

        <% end %>

      </div>
      
    </div>

    <nav aria-label="Page navigation">
      <ul class="pagination pagination-lg justify-content-center">
        <%== pagy_bootstrap_nav(@pagy) %>
      </ul>
    </nav>

    </div>
    </div>

</div>

